{% extends "_page.html" %}
{% import "post/_macros-post.html" as postMacros %}
{% import "event/_macros-event.html" as eventMacros %}
{% import "_macros-form.html" as formMacros %}

{% block styles %}
  {{ formMacros.editorStyles() }}
{% endblock %}

{% block body %}

<div class="container">
  <div class="row">
    <div class="col-lg-offset-1 col-lg-10">
      <h1>{{ post.get('title') }}</h1>
      {% if not post.get('published_at') %}
        <div class="alert alert-warning"><strong>Draft post</strong> Other users can't see it until it is published.</div>
      {% endif %}
      {{ postMacros.post(post, user, {hideHeading: true}) }}
    </div>
  </div>
  {% if post.get('special_post_type') !== 'article' %}
  <div class="row">
    {% set hasRelated = relatedEntry or relatedEvent %}
    <div class="col-md-7 col-lg-8 {{ 'col-lg-offset-2' if not hasRelated }} ">
      <h2>Comments</h2>
      {{ postMacros.comments(sortedComments, user, {allowMods: true, editComment: editComment}) }}
    </div>
    {% if hasRelated %}
    <div class="col-md-5 col-lg-4">
      <h2>Related</h2>
      {{ eventMacros.entryThumb(relatedEntry, 12) if relatedEntry }}
      {{ eventMacros.eventTable(relatedEvent, false) if relatedEvent }}
    </div>
    {% endif %}
  </div>
  {% endif %}
</div>

{% endblock %}

{% block scripts %} 
  {{ formMacros.editorScripts() }}
{% endblock %}
