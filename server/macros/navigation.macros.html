
{# ======== EXPAND/COLLAPSE BAR ========= #}

{# This bar must be added just after the block to expand, and have a common parent div with class="expandable".
   - options.manualScripting: lets the user implement the JS (mostly used on the home page)
   - options.maxHeight: customizes the maximum height before enabling the expand/collapse bar
#}
{% macro expandCollapse(options = {}) %}
<div class="expand-bar {{ 'js-expand-bar' if not options.manualScripting }}" data-max-height="{{ options.maxHeight or 600 }}">
  <span class="expand">
    <span class="fas fa-arrow-down"></span> 
    Expand
    <span class="fas fa-arrow-down"></span> 
  </span>
  <span class="collapse">
    <span class="fas fa-arrow-up"></span> 
    Collapse
    <span class="fas fa-arrow-up"></span> 
  </span>
</div>
{% endmacro %}

{# ======== PAGINATION ========= #}

{% macro pagination(currentPage = 1, pageCount = 1, baseUrl = '/posts?') %}
  {% set baseUrlQS = baseUrl | paginationBasePath %}
  {% set pagesToEnd = pageCount - currentPage %}
  {% set from = max(1, currentPage - max(5, 11 - pagesToEnd)) %}
  {% set to = min(pageCount, currentPage + max(5, 11 - currentPage)) %}
  {# TODO: make a way to reach first / last page when there are many pages #}
  {# class="{{ 'active' if currentPage === pageCount }}" #}
  {% if pageCount > 1 %}
  <ul class="pagination">
    {% if currentPage > 1 %}
    <li><a href="{{ baseUrlQS + '&p=' + (currentPage - 1) }}">Previous page</a></li>
    {% endif %}
    {% for page in range(from, to + 1) %}
    <li class="{{ 'active' if currentPage === page }}"><a href="{{ baseUrlQS + '&p=' + page }}">{{ page }}</a></li>
    {% endfor %}
    {% if currentPage < pageCount %}
    <li><a href="{{ baseUrlQS + '&p=' + (currentPage + 1) }}">Next page</a></li>
    {% endif %}
  </ul>
  {% endif %}
{% endmacro %}
